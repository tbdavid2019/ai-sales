# 📋 修復測試使用說明

## 🚀 快速測試指南

### 方法1：使用 Streamlit UI 測試（推薦）

```bash
# 1. 啟動 Streamlit 應用
streamlit run app_streamlit.py

# 2. 在瀏覽器中打開 http://localhost:8501
# 3. 按照以下步驟測試：
```

**測試步驟：**
1. **上傳名片圖片** → 系統應該識別出"王大偉"等資訊
2. **啟動攝影機** → 點擊"開始視覺分析"
3. **對著攝影機說"你好啊"** → 系統應該回應"王大偉您好！很高興認識您..."

### 方法2：使用 Gradio UI 測試

```bash
# 1. 啟動 Gradio 應用
python app_gradio.py

# 2. 在瀏覽器中打開 http://localhost:7860
# 3. 類似的測試步驟
```

### 方法3：使用 FastAPI 測試

```bash
# 1. 啟動 FastAPI 服務
python main.py

# 2. 在另一個終端運行測試
python test_api_integration.py
```

## 🧪 詳細測試流程

### 一、使用 Streamlit UI 實際測試

1. **啟動應用**
   ```bash
   streamlit run app_streamlit.py
   ```

2. **測試名片掃描**
   - 點擊"上傳名片圖片"
   - 選擇一張名片圖片
   - 確認系統正確識別姓名、公司等資訊

3. **測試攝影機對話**
   - 點擊"開始視覺分析"按鈕
   - 允許瀏覽器存取攝影機
   - 在文字框輸入"你好啊"
   - 點擊發送
   - **預期結果**：系統應該回應類似"王大偉您好！很高興認識您..."

### 二、使用測試腳本

如果您想使用測試腳本，需要先確保相關服務正在運行：

```bash
# 終端1：啟動 FastAPI 服務
python main.py

# 終端2：運行測試腳本
python test_api_integration.py

# 或者運行攝影機特定測試
python test_camera_fix.py
```

## 🔍 測試重點

### 修復前的問題表現
```
用戶：上傳名片 → ✅ 系統識別：王大偉
用戶：啟動攝影機 + "你好啊" → ❌ 系統：抱歉，無法清楚識別名片內容
```

### 修復後的正確表現
```
用戶：上傳名片 → ✅ 系統識別：王大偉 (card_agent)
用戶：啟動攝影機 + "你好啊" → ✅ 系統：王大偉您好！很高興認識您... (chat_agent + vision_agent)
```

## 📊 測試檢查清單

- [ ] 名片上傳功能正常
- [ ] 名片資訊正確識別和儲存
- [ ] 攝影機啟動正常
- [ ] 攝影機對話時能正確使用之前的名片資訊
- [ ] 系統不再錯誤地嘗試識別攝影機影像為名片
- [ ] 對話回應自然且包含用戶姓名

## 🐛 如果測試失敗

如果測試中發現問題，請檢查：

1. **確保所有依賴已安裝**
   ```bash
   pip install -r requirements.txt
   ```

2. **檢查 Redis 是否運行**（如果使用Redis）
   ```bash
   redis-server
   ```

3. **查看控制台日誌**
   - Streamlit 應用的終端輸出
   - 瀏覽器的開發者工具控制台

4. **檢查相關服務**
   - 確保 LLM 服務可用
   - 確保攝影機權限已授權

## 📝 測試報告

測試完成後，請記錄：
- ✅ 哪些功能正常
- ❌ 哪些功能還有問題
- 🔄 需要進一步調整的地方

## 🎯 最佳測試實踐

1. **按順序測試**：先測試名片掃描，再測試攝影機對話
2. **清除緩存**：每次測試前可以清除瀏覽器緩存
3. **使用真實數據**：使用真實的名片圖片測試效果更佳
4. **多場景測試**：測試不同的對話內容和情境

---

**建議的測試順序：**
1. 先用 Streamlit UI 進行實際操作測試
2. 再用測試腳本進行自動化測試
3. 最後用 FastAPI 文檔進行 API 測試

這樣能確保修復效果在各個層面都能正常工作！🎉